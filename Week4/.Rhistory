geom_point(aes(x=medageE,y=medincE, color = color), size = 3) +
scale_color_identity() +
scale_y_continuous(label = scales::dollar_format()) +
geom_hline(yintercept = avg_inc, linetype = "longdash") +
geom_vline(xintercept = avg_age, linetype = "longdash") +
geom_point(x = avg_age,y=avg_inc,size=3.5) +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "High/Low", vjust = 5, hjust = 5, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
labs(title = "Median Income per Median Age by PA County", x = "Age", y = "Income") +
coord_capped_cart(bottom = "right", left = "top")
pa
pa <- ggplot(pa_wide) +
geom_point(aes(x=medageE,y=medincE, color = color), size = 3) +
scale_color_identity() +
scale_y_continuous(label = scales::dollar_format()) +
geom_hline(yintercept = avg_inc, linetype = "longdash") +
geom_vline(xintercept = avg_age, linetype = "longdash") +
geom_point(x = avg_age,y=avg_inc,size=3.5) +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
labs(title = "Median Income per Median Age by PA County", x = "Age", y = "Income") +
coord_capped_cart(bottom = "right", left = "top")
pa
pa <- ggplot(pa_wide) +
geom_point(aes(x=medageE,y=medincE, color = color), size = 3) +
scale_color_identity() +
scale_y_continuous(label = scales::dollar_format()) +
geom_hline(yintercept = avg_inc, linetype = "longdash") +
geom_vline(xintercept = avg_age, linetype = "longdash") +
geom_point(x = avg_age,y=avg_inc,size=3.5) +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/High", vjust = -3, hjust = 3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent") +
labs(title = "Median Income per Median Age by PA County", x = "Age", y = "Income") +
coord_capped_cart(bottom = "right", left = "top")
pa
pa <- ggplot(pa_wide) +
geom_point(aes(x=medageE,y=medincE, color = color), size = 3) +
scale_color_identity() +
scale_y_continuous(label = scales::dollar_format()) +
geom_hline(yintercept = avg_inc, linetype = "longdash") +
geom_vline(xintercept = avg_age, linetype = "longdash") +
geom_point(x = avg_age,y=avg_inc,size=3.5) +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/High", vjust = -3, hjust = 3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "High/Low", vjust = 3, hjust = -3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "High/High", vjust = -3, hjust = -3, label.size = NA, fill = "transparent") +
labs(title = "Median Income per Median Age by PA County", x = "Age", y = "Income") +
coord_capped_cart(bottom = "right", left = "top")
pa
pa <- ggplot(pa_wide) +
geom_point(aes(x=medageE,y=medincE, color = color), size = 3) +
scale_color_identity() +
scale_y_continuous(label = scales::dollar_format()) +
geom_hline(yintercept = avg_inc, linetype = "longdash") +
geom_vline(xintercept = avg_age, linetype = "longdash") +
geom_point(x = avg_age,y=avg_inc,size=3.5) +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent", color = RED1) +
geom_label(x = avg_age, y = avg_inc, label = "Low/High", vjust = -3, hjust = 3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "High/Low", vjust = 3, hjust = -3, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "High/High", vjust = -3, hjust = -3, label.size = NA, fill = "transparent") +
labs(title = "Median Income per Median Age by PA County", x = "Age", y = "Income") +
coord_capped_cart(bottom = "right", left = "top")
pa
pa <- ggplot(pa_wide) +
geom_point(aes(x=medageE,y=medincE, color = color), size = 3) +
scale_color_identity() +
scale_y_continuous(label = scales::dollar_format()) +
geom_hline(yintercept = avg_inc, linetype = "longdash") +
geom_vline(xintercept = avg_age, linetype = "longdash") +
geom_point(x = avg_age,y=avg_inc,size=3.5) +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent", color = RED1) +
geom_label(x = avg_age, y = avg_inc, label = "Low/High", vjust = -3, hjust = 3, label.size = NA, fill = "transparent", color = BLUE1) +
geom_label(x = avg_age, y = avg_inc, label = "High/Low", vjust = 3, hjust = -3, label.size = NA, fill = "transparent", color = Orange1) +
geom_label(x = avg_age, y = avg_inc, label = "High/High", vjust = -3, hjust = -3, label.size = NA, fill = "transparent", color = GREEN1) +
labs(title = "Median Income per Median Age by PA County", x = "Age", y = "Income") +
coord_capped_cart(bottom = "right", left = "top")
pa <- ggplot(pa_wide) +
geom_point(aes(x=medageE,y=medincE, color = color), size = 3) +
scale_color_identity() +
scale_y_continuous(label = scales::dollar_format()) +
geom_hline(yintercept = avg_inc, linetype = "longdash") +
geom_vline(xintercept = avg_age, linetype = "longdash") +
geom_point(x = avg_age,y=avg_inc,size=3.5) +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent", color = RED1) +
geom_label(x = avg_age, y = avg_inc, label = "Low/High", vjust = -3, hjust = 3, label.size = NA, fill = "transparent", color = BLUE1) +
geom_label(x = avg_age, y = avg_inc, label = "High/Low", vjust = 3, hjust = -3, label.size = NA, fill = "transparent", color = ORANGE1) +
geom_label(x = avg_age, y = avg_inc, label = "High/High", vjust = -3, hjust = -3, label.size = NA, fill = "transparent", color = GREEN1) +
labs(title = "Median Income per Median Age by PA County", x = "Age", y = "Income") +
coord_capped_cart(bottom = "right", left = "top")
pa
theme_swd <- function() {
theme_minimal(base_size = 8, base_family = "serif") +
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
axis.line = element_line(size = .1, color = GRAY9),
axis.text = element_text(color = GRAY7),
axis.ticks.x = element_line(size = 0.5, color = GRAY9),
axis.ticks.y = element_line(size = 0.5, color = GRAY9),
axis.title = element_text(color = GRAY3),
axis.title.y = element_text(hjust = 1, margin = margin(0, 6, 0, 15, "pt")),
axis.title.x = element_text(hjust = 0, margin = margin(6, 0, 15, 0, "pt")),
plot.subtitle = element_text(color = GRAY4, size= 8),
plot.title = element_text(color = GRAY4, size= 12),
plot.title.position = "plot", # This aligns the plot title to the very left edge
plot.caption = element_text(hjust = 0, color = GRAY6),
plot.caption.position = "plot",
plot.margin = margin(.5,.5,.5,.5,"cm"),
strip.text = element_text(color = GRAY7))
}
theme_set(theme_swd())
pa <- ggplot(pa_wide) +
geom_point(aes(x=medageE,y=medincE, color = color), size = 3) +
scale_color_identity() +
scale_y_continuous(label = scales::dollar_format()) +
geom_hline(yintercept = avg_inc, linetype = "longdash") +
geom_vline(xintercept = avg_age, linetype = "longdash") +
geom_point(x = avg_age,y=avg_inc,size=3.5) +
geom_label(x = avg_age, y = avg_inc, label = "AVG", vjust = 1, label.size = NA, fill = "transparent") +
geom_label(x = avg_age, y = avg_inc, label = "Low/Low", vjust = 3, hjust = 3, label.size = NA, fill = "transparent", color = RED1) +
geom_label(x = avg_age, y = avg_inc, label = "Low/High", vjust = -3, hjust = 3, label.size = NA, fill = "transparent", color = BLUE1) +
geom_label(x = avg_age, y = avg_inc, label = "High/Low", vjust = 3, hjust = -3, label.size = NA, fill = "transparent", color = ORANGE1) +
geom_label(x = avg_age, y = avg_inc, label = "High/High", vjust = -3, hjust = -3, label.size = NA, fill = "transparent", color = GREEN1) +
labs(title = "Median Income per Median Age by PA County", x = "Age", y = "Income") +
coord_capped_cart(bottom = "right", left = "top")
pa
library(lubridate)
df3 <- read_csv(file.path("data", "FIG0209.csv")) %>% mutate(date = ymd(paste(Year, Month, 1)))
# Missing from this re-creation are the long x-axis ticks. Unclear on how to increase tick length and center the labels between ticks.
pt2 <- ggplot(df, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9) +
geom_line(aes(y = Avg), size = 2, color = GRAY4) +
geom_point(aes(y = Avg), size = 1, data = df %>% slice(n = 1), color = GRAY4) +
geom_point(aes(y = Avg), size = 4, data = df %>% slice(n = n()), color = GRAY4) +
geom_text(aes(y = Min), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = df %>% slice(n = 1)) +
geom_text(aes(y = Avg), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = df %>% slice(n = 1)) +
geom_text(aes(y = Max), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = df %>% slice(n = 1)) +
geom_text(aes(y = Avg, label = paste0("bold(", Avg, ")")), parse = T, nudge_x = 15, data = df %>% slice(n = n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = df$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(y = "Wait time (minutes)", x = NULL, title = "Passport control wait time", subtitle = "Past 13 months")
df3 <- read_csv(file.path("data", "FIG0209.csv")) %>% mutate(date = ymd(paste(Year, Month, 1)))
# Missing from this re-creation are the long x-axis ticks. Unclear on how to increase tick length and center the labels between ticks.
pt2 <- ggplot(df3, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9) +
geom_line(aes(y = Avg), size = 2, color = GRAY4) +
geom_point(aes(y = Avg), size = 1, data = df %>% slice(n = 1), color = GRAY4) +
geom_point(aes(y = Avg), size = 4, data = df %>% slice(n = n()), color = GRAY4) +
geom_text(aes(y = Min), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = df %>% slice(n = 1)) +
geom_text(aes(y = Avg), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = df %>% slice(n = 1)) +
geom_text(aes(y = Max), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = df %>% slice(n = 1)) +
geom_text(aes(y = Avg, label = paste0("bold(", Avg, ")")), parse = T, nudge_x = 15, data = df %>% slice(n = n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = df$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(y = "Wait time (minutes)", x = NULL, title = "Passport control wait time", subtitle = "Past 13 months")
df <- read_csv(file.path("data", "FIG0209.csv")) %>% mutate(date = ymd(paste(Year, Month, 1)))
# Missing from this re-creation are the long x-axis ticks. Unclear on how to increase tick length and center the labels between ticks.
pt <- ggplot(df, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9) +
geom_line(aes(y = Avg), size = 2, color = GRAY4) +
geom_point(aes(y = Avg), size = 1, data = df %>% slice(n = 1), color = GRAY4) +
geom_point(aes(y = Avg), size = 4, data = df %>% slice(n = n()), color = GRAY4) +
geom_text(aes(y = Min), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = df %>% slice(n = 1)) +
geom_text(aes(y = Avg), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = df %>% slice(n = 1)) +
geom_text(aes(y = Max), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = df %>% slice(n = 1)) +
geom_text(aes(y = Avg, label = paste0("bold(", Avg, ")")), parse = T, nudge_x = 15, data = df %>% slice(n = n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = df$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(y = "Wait time (minutes)", x = NULL, title = "Passport control wait time", subtitle = "Past 13 months")
# Missing from this re-creation are the long x-axis ticks. Unclear on how to increase tick length and center the labels between ticks.
pt <- ggplot(df, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9) +
geom_line(aes(y = Avg), linewidth = 2, color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 1, data = df %>% slice(1), color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 4, data = df %>% slice(n()), color = GRAY4) +
geom_text(aes(y = Min), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = df %>% slice(1)) +
geom_text(aes(y = Avg), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = df %>% slice(1)) +
geom_text(aes(y = Max), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = df %>% slice(n = 1)) +
geom_text(aes(y = Avg, label = paste0("bold(", Avg, ")")), parse = T, nudge_x = 15, data = df %>% slice(n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = df$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(y = "Wait time (minutes)", x = NULL, title = "Passport control wait time", subtitle = "Past 13 months")
# Missing from this re-creation are the long x-axis ticks. Unclear on how to increase tick length and center the labels between ticks.
pt <- ggplot(df, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9) +
geom_line(aes(y = Avg), linewidth = 2, color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 1, data = df %>% slice(1), color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 4, data = df %>% slice(n()), color = GRAY4) +
geom_text(aes(y = Min), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = df %>% slice(1)) +
geom_text(aes(y = Avg), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = df %>% slice(1)) +
geom_text(aes(y = Max), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = df %>% slice(1)) +
geom_text(aes(y = Avg, label = paste0("bold(", Avg, ")")), parse = T, nudge_x = 15, data = df %>% slice(n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = df$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(y = "Wait time (minutes)", x = NULL, title = "Passport control wait time", subtitle = "Past 13 months")
pt
t <- ggplot(df, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9)
pt
pt <- ggplot(df, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9)
pt
pt <- ggplot(df, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9) +
geom_line(aes(y = Avg), linewidth = 2, color = GRAY4)
pt
pt
pt <- ggplot(df, aes(x = date)) +
geom_ribbon(aes(ymin = Min, ymax = Max), fill = GRAY9) +
geom_line(aes(y = Avg), linewidth = 2, color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 1, data = df %>% slice(1), color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 4, data = df %>% slice(n()), color = GRAY4) +
geom_text(aes(y = Min), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = df %>% slice(1)) +
geom_text(aes(y = Avg), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = df %>% slice(1)) +
geom_text(aes(y = Max), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = df %>% slice(1)) +
geom_text(aes(y = Avg, label = paste0("bold(", Avg, ")")), parse = T, nudge_x = 15, data = df %>% slice(n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = df$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(y = "Wait time (minutes)", x = NULL, title = "Passport control wait time", subtitle = "Past 13 months")
pt
years <- 2005:2019
names(years) <- years
deschutes_value <- map_dfr(years, ~{
get_acs(
geography = "county",
variables = "B25077_001",
state = "PA",
county = "Philadelphia",
year = .x,
survey = "acs1"
ggplot(deschutes_value, aes(x = year, y = estimate, group = 1)) +
deschutes_value <- map_dfr(years, ~{
get_acs(
geography = "county",
variables = "B25077_001",
state = "PA",
county = "Philadelphia",
year = .x,
survey = "acs1"
)
}, .id = "year")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = "navy",
alpha = 0.4) +
geom_line(color = "navy") +
geom_point(color = "navy", size = 2) +
theme_minimal(base_size = 12) +
scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
philly_value <- map_dfr(years, ~{
get_acs(
geography = "county",
variables = "B25077_001",
state = "PA",
county = "Philadelphia",
year = .x,
survey = "acs1"
)
}, .id = "year")
philly_value <- map_dfr(years, ~{
get_acs(
geography = "county",
variables = "B25077_001",
state = "PA",
county = "Philadelphia",
year = .x,
survey = "acs1"
)
}, .id = "year")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = "navy",
alpha = 0.4) +
geom_line(color = "navy") +
geom_point(color = "navy", size = 2) +
theme_minimal(base_size = 12) +
scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = "navy",
alpha = 0.4) +
geom_line(color = "navy") +
geom_point(color = "navy", size = 2) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = GRAY9,
alpha = 0.4) +
geom_line(aes(y = Avg), linewidth = 2, color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 1, data = df %>% slice(1), color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 4, data = df %>% slice(n()), color = GRAY4) +
geom_text(aes(y = Min), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = df %>% slice(1)) +
geom_text(aes(y = Avg), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = df %>% slice(1)) +
geom_text(aes(y = Max), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = df %>% slice(1)) +
geom_text(aes(y = Avg, label = paste0("bold(", Avg, ")")), parse = T, nudge_x = 15, data = df %>% slice(n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = df$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(y = "Wait time (minutes)", x = NULL, title = "Passport control wait time", subtitle = "Past 13 months")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = GRAY9,
alpha = 0.4) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 1, data = df %>% slice(1), color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 4, data = df %>% slice(n()), color = GRAY4) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
View(philly_value)
View(df)
estimate <- philly_value$estimate
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = GRAY9,
alpha = 0.4) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 1, data = df %>% slice(1), color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 4, data = df %>% slice(n()), color = GRAY4) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
estimate <- philly_value$estimate
year <- philly_value$year
moe <- philly_value$moe
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = GRAY9,
alpha = 0.4) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 1, data = df %>% slice(1), color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 4, data = df %>% slice(n()), color = GRAY4) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = "navy",
alpha = 0.4) +
geom_line(color = "navy") +
geom_point(color = "navy", size = 2) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = "navy",
alpha = 0.4) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(color = "navy", size = 2) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = "navy",
alpha = 0.4) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = Avg), linewidth = 1, data = philly_value %>% slice(1), color = GRAY4) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = "navy",
alpha = 0.4) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 1, data = philly_value %>% slice(1), color = GRAY4) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
geom_point(aes(y = Avg), linewidth = 4, data = df %>% slice(n()), color = GRAY4) +
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = "navy",
alpha = 0.4) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 1, data = philly_value %>% slice(1), color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 4, data = philly_value %>% slice(n()), color = GRAY4) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = GRAY9) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 1, data = philly_value %>% slice(1), color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 4, data = philly_value %>% slice(n()), color = GRAY4) +
theme_minimal(base_size = 12) +
#scale_y_continuous(labels = label_dollar(scale = .001, suffix = "k")) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
geom_text(aes(y = Min), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = df %>% slice(1)) +
geom_text(aes(y = Avg), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = df %>% slice(1)) +
geom_text(aes(y = Max), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = df %>% slice(1)) +
geom_text(aes(y = Avg, label = paste0("bold(", Avg, ")")), parse = T, nudge_x = 15, data = df %>% slice(n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = df$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(y = "Wait time (minutes)", x = NULL, title = "Passport control wait time", subtitle = "Past 13 months")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = GRAY9) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 1, data = philly_value %>% slice(1), color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 4, data = philly_value %>% slice(n()), color = GRAY4) +
geom_text(aes(y = "estimate - moe"), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = philly_value %>% slice(1)) +
geom_text(aes(y = estimate), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(AVG)", data = philly_value %>% slice(1)) +
geom_text(aes(y = "estimate + moe"), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = philly_value %>% slice(1)) +
geom_text(aes(y = estimate, label = paste0("bold(", estimate, ")")), parse = T, nudge_x = 15, data = philly_value %>% slice(n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = philly_value$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
ggplot(philly_value, aes(x = year, y = estimate, group = 1)) +
geom_ribbon(aes(ymax = estimate + moe, ymin = estimate - moe),
fill = GRAY9) +
geom_line(aes(y = estimate), linewidth = 2, color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 1, data = philly_value %>% slice(1), color = GRAY4) +
geom_point(aes(y = estimate), linewidth = 4, data = philly_value %>% slice(n()), color = GRAY4) +
geom_text(aes(y = "estimate - moe"), hjust = -0.1, vjust = -1.1, color = GRAY5, parse = T, label = sprintf("bold(MIN)"), data = philly_value %>% slice(1)) +
geom_text(aes(y = estimate), hjust = -0.1, vjust = -0.5, parse = T, label = "bold(estimate)", data = philly_value %>% slice(1)) +
geom_text(aes(y = "estimate + moe"), hjust = -0.1, vjust = 2, color = GRAY5, parse = T, label = "bold(MAX)", data = philly_value %>% slice(1)) +
geom_text(aes(y = estimate, label = paste0("bold(", estimate, ")")), parse = T, nudge_x = 15, data = philly_value %>% slice(n())) +
scale_y_continuous(breaks = seq(0, 40, 5), limit = c(0, 40)) +
scale_x_date(
date_labels = "%b", breaks = philly_value$date, expand = c(0, 0),
limits = c(ymd("2014-08-16", ymd("2015-10-01")))
) +
labs(title = "Median home value in Philly County, PA",
x = "Year",
y = "ACS estimate",
caption = "Shaded area represents margin of error around the ACS estimate")
